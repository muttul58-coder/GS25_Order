<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>주문서 - LG 생산기술원점</title>

    <!-- CSS -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/print.css">
    <link rel="stylesheet" href="css/responsive.css">

    <!-- 카카오 우편번호 서비스 -->
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <!-- 상품 데이터 자동 로드 - products.js 파일이 같은 폴더에 있어야 합니다 -->
    <script src="products.js"></script>
    <!-- 구글 폼 설정 파일 - config.js 파일이 같은 폴더에 있어야 합니다 -->
    <script src="config.js"></script>
    <!-- 이미지 캡쳐용 html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- 앱 모듈 (의존성 순서대로 로딩) -->
    <script src="js/utils.js"></script>
    <script src="js/address.js"></script>
    <script src="js/product.js"></script>
    <script src="js/delivery.js"></script>
    <script src="js/copy-sync.js"></script>
    <script src="js/validation.js"></script>
    <script src="js/section.js"></script>
    <script src="js/print-image.js"></script>
    <script src="js/submit.js"></script>
    <script src="js/init.js"></script>
</head>
<body>
    <div class="container">
        <!-- 알림 메시지 영역 (인쇄 시 숨김) -->
        <div id="alertBox" class="alert"></div>

        <!-- 헤더 - 주문서 제목 -->
        <div class="header">
            <h1>주 문 서</h1>
        </div>

        <!-- 상단 정보 - 담당자 및 주문 일시 -->
        <div class="top-info">
            <div class="shop-info">
                LG 생산기술원점&nbsp;&nbsp;&nbsp;담당 : 양창호&nbsp;&nbsp;&nbsp;휴대전화 : 010-7568-3522
            </div>
            <div class="date-info">
                주문 일시 : <span id="currentDateTime"></span>
            </div>
        </div>

        <!-- 주문자 정보 컨테이너 -->
        <div class="orderer-info-container">
            <div class="orderer-info-badge">주문 정보</div>
            <div class="table-responsive">
                <table>
                    <tr>
                        <th style="width: 90px;">성명</th>
                        <th style="width: 160px;">전화번호</th>
                        <th style="width: 150px;">우편번호</th>
                        <th>주소</th>
                    </tr>
                    <tr>
                        <td><input type="text" id="ordererName" placeholder="성명 입력" required></td>
                        <td><input type="tel" id="ordererPhone" placeholder="전화번호 입력" required></td>
                        <td>
                            <div class="postal-input-wrapper">
                                <input type="text" id="ordererPostal" placeholder="우편번호" maxlength="5" required>
                                <button type="button" class="postal-search-btn no-print" onclick="searchOrdererAddress()">검색</button>
                            </div>
                        </td>
                        <td class="address-field">
                            <input type="text" id="ordererAddress" placeholder="기본주소" required>
                            <input type="text" id="ordererAddressDetail" placeholder="상세주소 입력">
                        </td>
                    </tr>
                </table>
            </div>

            <!-- 상품 정보 테이블 -->
            <div class="section-header product-section">상품 정보</div>
            <div class="table-responsive">
                <table class="product-section" id="productTable">
                    <thead>
                        <tr>
                            <th style="width: 20px;">No.</th>
                            <th style="width: 80px;">상품 코드</th>
                            <th>상품이름</th>
                            <th style="width: 70px;">행사</th>
                            <th style="width: 70px;">수량</th>
                            <th style="width: 100px;">단가</th>
                            <th style="width: 100px;">금액</th>
                            <th style="width: 100px;" class="no-print">작업</th>
                        </tr>
                    </thead>
                    <tbody class="product-table-body" id="productTableBody">
                        <!-- 첫 번째 상품 행 -->
                        <tr class="product-row" data-row="1">
                            <td class="row-number">1</td>
                            <td><input type="text" class="product-code" placeholder="00-00" required></td>
                            <td><input type="text" class="product-name" placeholder="상품이름" readonly></td>
                            <td>
                                <select class="event-type">
                                    <option value="">없음</option>
                                    <option value="1+1">1+1</option>
                                    <option value="2+1">2+1</option>
                                    <option value="3+1">3+1</option>
                                    <option value="4+1">4+1</option>
                                    <option value="5+1">5+1</option>
                                    <option value="6+1">6+1</option>
                                    <option value="7+1">7+1</option>
                                    <option value="8+1">8+1</option>
                                    <option value="9+1">9+1</option>
                                    <option value="10+1">10+1</option>
                                    <option value="11+1">11+1</option>
                                    <option value="12+1">12+1</option>
                                    <option value="13+1">13+1</option>
                                    <option value="14+1">14+1</option>
                                    <option value="15+1">15+1</option>
                                    <option value="16+1">16+1</option>
                                    <option value="17+1">17+1</option>
                                    <option value="18+1">18+1</option>
                                    <option value="19+1">19+1</option>
                                    <option value="20+1">20+1</option>
                                </select>
                            </td>
                            <td><input type="number" class="quantity" value="1" min="1" required></td>
                            <td><input type="text" class="unit-price" placeholder="______" required></td>
                            <td><input type="text" class="total-price" readonly></td>
                            <td class="no-print">
                                <div class="action-buttons">
                                    <button type="button" class="remove-btn" onclick="removeProductRow(this)">삭제</button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <!-- 행 추가 버튼 -->
                        <tr class="no-print">
                            <td colspan="8" class="add-row-container">
                                <button type="button" class="add-btn" onclick="addProductRow()">+ 상품 추가</button>
                            </td>
                        </tr>
                        <!-- 합계 행 -->
                        <tr class="total-row">
                            <td colspan="4">총 수량</td>
                            <td class="section-total-quantity" id="totalQuantity">0</td>
                            <td>총 금액</td>
                            <td class="section-grand-total" id="totalAmount">0</td>
                            <td class="no-print"></td>
                        </tr>
                        <!-- 바코드 이미지 1줄 -->
                        <tr class="barcode-row barcode-row-1">
                            <td colspan="12" class="barcode-container">
                                <div class="barcode-grid">
                                    <div class="barcode-slot"></div>
                                    <div class="barcode-slot"></div>
                                    <div class="barcode-slot"></div>
                                    <div class="barcode-slot"></div>
                                </div>
                            </td>
                        </tr>
                        <!-- 바코드 이미지 2줄 (기본 숨김) -->
                        <tr class="barcode-row barcode-row-2" style="display:none;">
                            <td colspan="12" class="barcode-container">
                                <div class="barcode-grid">
                                    <div class="barcode-slot"></div>
                                    <div class="barcode-slot"></div>
                                    <div class="barcode-slot"></div>
                                    <div class="barcode-slot"></div>
                                </div>
                            </td>
                        </tr>
                        <!-- 바코드 이미지 3줄 (기본 숨김) -->
                        <tr class="barcode-row barcode-row-3" style="display:none;">
                            <td colspan="12" class="barcode-container">
                                <div class="barcode-grid">
                                    <div class="barcode-slot"></div>
                                    <div class="barcode-slot"></div>
                                    <div class="barcode-slot"></div>
                                    <div class="barcode-slot"></div>
                                </div>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>

        <!-- 주문 섹션들을 담는 컨테이너 -->
        <div id="orderSectionsContainer">
            <!-- 첫 번째 섹션 (기본) -->
            <div class="order-section" data-section="1">
                <div class="section-number-row">
                    <div class="section-number">배송 정보 #1</div>
                    <div class="delivery-date-area">
                        <label>배송 희망 일 :
                            <input type="date" class="delivery-date" value="2026-02-09" lang="ko">
                        </label>
                    </div>
                </div>

                <!-- 보내는 분 정보 테이블 -->
                <div class="section-header send-section">
                    <span>보내는 분</span>
                    <div class="header-checkbox-area no-print">
                        <label class="checkbox-label">
                            <input type="checkbox" class="copy-orderer-info" onchange="toggleOrdererInfoCopy(this)">
                            <span>주문 정보와 동일</span>
                        </label>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="send-section">
                        <tr>
                            <th style="width: 90px;">성명</th>
                            <th style="width: 160px;">전화번호</th>
                            <th style="width: 150px;">우편번호</th>
                            <th>주소</th>
                        </tr>
                        <tr>
                            <td><input type="text" class="sender-name" placeholder="성명 입력" required></td>
                            <td><input type="tel" class="sender-phone" placeholder="전화번호 입력" required></td>
                            <td>
                                <div class="postal-input-wrapper">
                                    <input type="text" class="sender-postal" placeholder="우편번호" maxlength="5" required>
                                    <button type="button" class="postal-search-btn no-print" onclick="searchSenderAddress(this)">검색</button>
                                </div>
                            </td>
                            <td class="address-field">
                                <input type="text" class="sender-address" placeholder="기본주소" required>
                                <input type="text" class="sender-address-detail" placeholder="상세주소 입력">
                            </td>
                        </tr>
                    </table>
                </div>

                <!-- 받는 분 정보 테이블 -->
                <div class="section-header receiver-section">
                    <span>받는 분</span>
                    <div class="header-checkbox-area no-print">
                        <label class="checkbox-label">
                            <input type="checkbox" class="copy-orderer-to-receiver" onchange="toggleReceiverInfoCopy(this, 'orderer')">
                            <span>주문 정보와 동일</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" class="copy-sender-to-receiver" onchange="toggleReceiverInfoCopy(this, 'sender')">
                            <span>보내는 분 정보와 동일</span>
                        </label>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="receiver-section">
                        <tr>
                            <th style="width: 90px;">성명</th>
                            <th style="width: 160px;">전화번호</th>
                            <th style="width: 150px;">우편번호</th>
                            <th>주소</th>
                        </tr>
                        <tr>
                            <td><input type="text" class="receiver-name" placeholder="성명 입력" required></td>
                            <td><input type="tel" class="receiver-phone" placeholder="전화번호입력" required></td>
                            <td>
                                <div class="postal-input-wrapper">
                                    <input type="text" class="receiver-postal" placeholder="우편번호" maxlength="5" required>
                                    <button type="button" class="postal-search-btn no-print" onclick="searchReceiverAddress(this)">검색</button>
                                </div>
                            </td>
                            <td class="address-field">
                                <input type="text" class="receiver-address" placeholder="기본주소" required>
                                <input type="text" class="receiver-address-detail" placeholder="상세주소 입력">
                            </td>
                        </tr>
                    </table>
                </div>

                <!-- 배송 상품 테이블 -->
                <div class="section-header delivery-product-section">
                    <span>배송 상품</span>
                </div>
                <div class="table-responsive">
                    <table class="delivery-product-section">
                        <thead>
                            <tr>
                                <th style="width: 40px;">No.</th>
                                <th style="width: 100px;">상품코드</th>
                                <th>상품이름</th>
                                <th style="width: 70px;">수량</th>
                                <th style="width: 100px;" class="no-print">작업</th>
                            </tr>
                        </thead>
                        <tbody class="delivery-product-body">
                            <tr class="delivery-product-row" data-row="1">
                                <td class="row-number">1</td>
                                <td>
                                    <select class="delivery-product-code-select" onchange="onDeliveryProductCodeChange(this)">
                                        <option value="">-- 선택 --</option>
                                    </select>
                                </td>
                                <td><input type="text" class="delivery-product-name" placeholder="상품이름" readonly></td>
                                <td><input type="number" class="delivery-product-qty" value="0" min="0" onchange="validateDeliveryQuantities()" oninput="validateDeliveryQuantities()"></td>
                                <td class="no-print">
                                    <div class="action-buttons">
                                        <button type="button" class="remove-btn" onclick="removeDeliveryProductRow(this)">삭제</button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="add-row-container no-print">
                    <button type="button" class="add-btn" onclick="addDeliveryProductRow(this)">+ 상품 추가</button>
                </div>
                <div class="delivery-quantity-message"></div>
            </div>
            <!-- 첫 번째 섹션 끝 -->
        </div>
        <!-- orderSectionsContainer 끝 -->

        <!-- 전체 합계 영역 -->
        <!-- 하단 버튼 영역 (인쇄 시 숨김) -->
        <div class="button-container no-print">
            <button type="button" class="add-section-btn" onclick="addSection()">➕ 배송 정보 추가</button>
            <button type="button" class="print-only-btn" onclick="printOnly()">🖨️ 인쇄</button>
            <button type="button" class="pdf-btn" onclick="saveAsImage()">📷 이미지 저장</button>
            <button type="button" class="submit-only-btn" onclick="submitOnly()">📤 주문 전송</button>
            <button type="button" class="print-btn" onclick="printOrder()">🖨️ 인쇄 및 주문 전송</button>
        </div>
    </div>
    <!-- container 끝 -->
</body>
</html>
