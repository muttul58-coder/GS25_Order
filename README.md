# GS25 주문서 시스템

GS25 편의점 택배 주문서 웹 애플리케이션입니다.
다중 배송지 관리, 실시간 금액 계산, 인쇄 최적화, Google Forms 연동을 지원합니다.

## 배포 링크

- **주문서 페이지**: https://muttul58-coder.github.io/GS25_Order/order_form.html
- **응답 시트**: https://docs.google.com/spreadsheets/d/1J_qtVbK5QmU3rDsSq3o_ieaCo4LDOmfE7orWqVzsLPY/edit?gid=1762982959#gid=1762982959

---

## 주요 기능

| 기능 | 설명 |
|------|------|
| **다중 배송 섹션** | 여러 배송지(보내는 분/받는 분/배송상품)를 섹션 단위로 추가/삭제 |
| **상품 검색 및 선택** | 646개 상품 DB에서 상품코드 입력 시 자동 조회 |
| **행사 할인 자동 계산** | 1+1, 2+1 프로모션 적용 시 결제 수량 자동 산출 |
| **정보 자동 복사** | 주문자 → 보내는 분, 보내는 분 → 받는 분 체크박스 연동 |
| **주소 검색** | Daum 우편번호 API 연동 |
| **바코드 표시** | 주문 상품에 해당하는 바코드 이미지 자동 표시 (최대 12개) |
| **인쇄 최적화** | A4 규격 인쇄 레이아웃, 세로 제목 셀, 입력값 보존 |
| **Google Forms 제출** | 주문 데이터를 JSON으로 구조화하여 Google Forms에 전송 |
| **배송수량 검증** | 주문 수량 대비 배송 수량 실시간 비교 및 경고 |
| **순차 입력 검증** | 이전 섹션 완성 전 다음 섹션 추가 차단 |

---

## 파일 구조

```
HTML/
├── order_form.html       # 메인 파일 (CSS + JS 인라인 포함, ~3500줄)
├── config.js             # Google Forms 설정 (URL, Entry ID)
├── products.js           # 상품 데이터베이스 (646개 상품)
├── apps_script.js        # Google Apps Script (시트 자동 생성)
├── BarcodeImgs/          # 바코드 이미지 (상품코드별 JPEG)
│   ├── 08-01.jpg
│   ├── 09-02.jpg
│   └── ...
├── js/                   # 미사용 파일 (로드되지 않음)
│   ├── print.js
│   ├── section.js
│   └── ...
└── README.md
```

### 핵심 파일 설명

| 파일 | 역할 |
|------|------|
| `order_form.html` | 전체 애플리케이션. HTML 구조, CSS 스타일, JavaScript 로직이 모두 인라인으로 포함 |
| `config.js` | Google Forms URL 및 Entry ID 설정. `<script src>`로 로드 |
| `products.js` | 상품코드-상품명-가격 매핑 객체. `<script src>`로 로드 |
| `apps_script.js` | Google Sheets에서 실행하는 Apps Script. 폼 응답을 파싱하여 주문서 시트 자동 생성 |
| `BarcodeImgs/` | 상품코드에 대응하는 바코드 이미지 폴더 (예: `08-01.jpg`) |

> **참고**: `js/` 폴더의 파일들은 HTML에서 `<script src>`로 로드하지 않으므로 실제 동작에 영향 없음. 모든 로직은 `order_form.html` 인라인 코드에 존재.

---

## 화면 구성

### 1. 주문자 정보 (Cyan 테마)
- 성명, 전화번호, 우편번호, 기본주소, 상세주소
- 상품정보 테이블 (번호, 상품코드, 상품이름, 행사, 수량, 단가, 금액)
- 바코드 이미지 영역 (3행 x 4열, 최대 12개)

### 2. 배송 섹션 (반복 가능)
- **배송일자** 선택 (섹션 상단 뱃지)
- **보내는 분** (Orange 테마) - 성명, 전화번호, 주소 + "주문자 정보와 동일" 체크박스
- **받는 분** (Purple 테마) - 성명, 전화번호, 주소 + 주문자/보내는 분 복사 체크박스
- **배송 상품** (Teal 테마) - 주문 상품 드롭다운 선택, 수량 입력, 수량 검증 메시지

### 3. 하단 버튼
- 배송정보 추가 / 인쇄만 / 제출만 / 인쇄 & 제출

---

## 외부 의존성

| 의존성 | 용도 |
|--------|------|
| [Daum Postcode API](https://postcode.map.daum.net/guide) | 우편번호/주소 검색 |
| Google Forms | 주문 데이터 수집 |
| Google Apps Script | 응답 데이터 → 시트 자동 변환 (선택) |

별도 빌드 도구나 프레임워크 없이 순수 HTML/CSS/JavaScript로 동작합니다.

---

## 사용 방법

### 기본 사용

1. `order_form.html`을 브라우저에서 열기
2. 주문자 정보 입력
3. 상품코드 입력 → 상품명/단가 자동 조회 → 수량 입력
4. 배송 섹션에서 보내는 분/받는 분/배송상품 입력
5. 필요 시 "배송정보 추가" 버튼으로 섹션 추가
6. "인쇄 & 제출" 버튼 클릭

### 상품코드 입력 형식

- `8-1` → 자동으로 `08-01`로 변환
- `08-01`, `106-09` 등 직접 입력 가능

### 행사(프로모션) 계산

| 행사 | 입력 수량 | 결제 수량 | 설명 |
|------|-----------|-----------|------|
| 없음 | 5 | 5 | 전량 결제 |
| 1+1 | 5 | 3 | 2개 묶음당 1개만 결제 |
| 2+1 | 5 | 4 | 3개 묶음당 2개만 결제 |

---

## Google Forms 연동 설정

### 1단계: config.js 편집

```javascript
const GOOGLE_FORM_CONFIG = {
    formUrl: "https://docs.google.com/forms/d/e/YOUR_FORM_ID/formResponse",
    entries: {
        dateTime:  "entry.1513670625",
        name:      "entry.1154584229",
        phone:     "entry.1054209127",
        orderData: "entry.941076937"
    }
};
```

### 2단계: Entry ID 확인 방법

1. Google Forms 편집 → 우측 상단 메뉴(⋮) → "미리 채우기 링크 가져오기"
2. 각 질문에 샘플 답변 입력 → "링크 가져오기" 클릭
3. 생성된 URL에서 `entry.숫자` 부분 추출

### 3단계: 테스트

1. `config.js` 저장 후 `order_form.html` 새로고침
2. 설정 상태 확인 (녹색 체크: 정상)
3. 테스트 주문 입력 → 제출 → Google Forms 응답 시트 확인

### Google Apps Script 연동 (선택)

`apps_script.js`를 Google Sheets의 Apps Script 편집기에 붙여넣으면:
- 폼 제출 시 자동으로 주문서 시트 생성
- 주문자/보내는 분/받는 분 정보 및 상품 목록 자동 정리
- 색상 코딩 및 서식 적용

---

## 제출 데이터 구조

Google Forms에 전송되는 JSON 구조:

```json
{
  "주문자정보": {
    "성명": "", "전화번호": "", "우편번호": "",
    "기본주소": "", "상세주소": ""
  },
  "상품목록": [
    { "상품코드": "", "상품이름": "", "행사": "", "수량": 0, "단가": 0, "금액": 0 }
  ],
  "주문목록": [
    {
      "주문번호": 1,
      "보내는분": { "성명": "", "전화번호": "", "우편번호": "", "기본주소": "", "상세주소": "" },
      "받는분":   { "성명": "", "전화번호": "", "우편번호": "", "기본주소": "", "상세주소": "" },
      "배송상품목록": [
        { "상품코드": "", "상품이름": "", "수량": 0 }
      ]
    }
  ],
  "전체합계": { "총주문건수": 0, "총수량": 0, "총금액": 0 }
}
```

---

## 인쇄 관련 참고사항

- A4 용지 규격 (210mm x 297mm) 최적화
- 인쇄 시 세로 제목 셀이 자동 추가됨
- 입력 필드의 값은 DOM 노드 참조 방식으로 보존 (`innerHTML` 대신 노드 이동/복원)
- `@media print` CSS로 불필요한 UI 요소 자동 숨김

---

## 주의사항

- `config.js`, `products.js`, `order_form.html`은 **반드시 같은 폴더**에 위치해야 합니다
- `BarcodeImgs/` 폴더도 같은 위치에 있어야 바코드가 표시됩니다
- `js/` 폴더의 파일을 수정해도 동작에 반영되지 않습니다
- 코드 수정 시 `order_form.html` 내 인라인 스크립트를 직접 편집해야 합니다

---

## 문제 해결

| 증상 | 해결 방법 |
|------|-----------|
| 설정 상태가 빨간색 | `config.js`가 같은 폴더에 있는지, 내용이 올바른지 확인 |
| "Entry ID가 설정되지 않았습니다" | `config.js`에서 모든 Entry ID가 `entry.숫자` 형태인지 확인 |
| Google Forms에 데이터 미전송 | `formUrl`이 `/formResponse`로 끝나는지, Entry ID가 일치하는지 확인. 브라우저 콘솔(F12) 오류 확인 |
| 상품코드 입력 시 조회 안 됨 | `products.js`가 같은 폴더에 있는지 확인 |
| 바코드 이미지 미표시 | `BarcodeImgs/` 폴더와 해당 상품코드 이미지 파일 존재 여부 확인 |
| 인쇄 후 데이터 사라짐 | `order_form.html`의 print 이벤트 핸들러가 DOM 노드 참조 방식인지 확인 |

---

## 상품 카테고리 (products.js)

| 코드 범위 | 카테고리 |
|-----------|----------|
| 08-12 | 한우/축산 세트 |
| 14-18 | 수산/건어물 |
| 20-25 | 과일 |
| 28-29 | 인삼/건강식품 |
| 30-34 | 잡곡/양념 |
| 35-36 | 가공식품 |
| 38-39 | 과자/제과 |
| 41-48 | 축산 가공 |
| 58-69 | 주류 |
| 70-73 | 음료 |
| 75-79 | 화장품/생활용품 |
| 81-87 | 건강기능식품 |
| 90-99 | 가전/생활가전 |
| 100-106 | 기타 |
